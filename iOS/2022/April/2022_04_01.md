# SwiftUI 기초 공부 시작
[Apple SwiftUI Tutorials]](https://developer.apple.com/tutorials/swiftui/) 네시간 코스를 들으며, UIKit과 다른 부분을 탐색한다.

# 목차
1. Creating and Combining Views
2. Progress bar를 Circle로 구현하고, 1초마다 percent가 증가하기
3. SwiftUI에서 TableViewCell같은 역할을 하는 List

# 1. Creating and Combining Views
- command-click을 통해서 inspector창을 통해서 text view를 customize하는 것이 가능하다.
- VStack에 추가하지 않고, view들을 추가했을 경우, 모두 alignment가 .center에 default로 맞춰진다. 


# 2. Progress bar를 Circle로 만들어 보기
## 1) 투명도가 큰 원 만들기

<img src="https://github.com/yudonlee/TIL/blob/main/iOS/2022/April/pictures/04_01_transparentCircle.png" width="400" height="400"> 

```swift
ZStack {
        Circle()
    //                lineWidth로 지정된 stroke copy로 새로운 shape를 생성시켜준다. 
    //                stroke를 지정하지 않으면 filled된 circle이 만들어진다.
                .stroke(lineWidth: 20.0)
    //                opacity는 투명성(transparency)를 의미한다.
                .opacity(0.3)
                .foregroundColor(.red)
                .frame(width: 150, height: 150)
            
        }
```
위 코드를 통해서, 사진과 같이 투명도가 있는 원이 만들어 진다

## 2) 투명도가 없는 원을 만들어 진행상황 표시하기.
<img src="https://github.com/yudonlee/TIL/blob/main/iOS/2022/April/pictures/04_01_progressCircle.png" width="400" height="400">

```swift
ZStack {
            Circle()
                .stroke(lineWidth: 20.0)
                .opacity(0.3)
                .foregroundColor(.red)
            Circle()
//              trim함수를 통해서, 원에서 원하는 구간만큼 자르게 된다. 
                .trim(from: 0.0, to: CGFloat(min(progressCookedValue, 100) / 100))
                .stroke(style: StrokeStyle(lineWidth: 20.0, lineCap: .round, lineJoin: .round))
                .foregroundColor(.red)
//              이떄 rotation Effect를 통해서 회전 시키지 않으면, 원에서 시작지점이 3시이다. 
                .rotationEffect(.degrees(-90))
            Text("\(String(format: "%.1f" ,(progressCookedValue)))% 조리가 완료 되었습니다.")
                .fontWeight(.bold)
        }
```
      
위 코드를 통해서, 투명도가 없는 진한 원과 투명도가 있는 원이 overlap된다.      
이때 trim함수의 용도는 원에서 원하는 부분만큼 자르는 것으로서, 3시부터 시계방향에서 시작되어 parameter to값을 기준으로 자르게 된다.(0.0 <= from, to <= 1.0)      
그래서 만약 12시부터 progress bar를 만들고 싶다면, rotationEffect함수를 통해서 -90도 회전시켜 주어야 한다.      

## 3) timer를 통해서 progress bar를 1초마다 업데이트 하기
SwiftUI에서 timer를 통해서 1초마다 특정 statement를 수행하여 progress를 업데이트 시켜줍니다. 
<img src="https://github.com/yudonlee/TIL/blob/main/iOS/2022/April/pictures/04_01_progressBarRecording.gif" width="400" height="400">

```swift
struct TimeElapsed: View {
    @State var progressCookedValue: Double = 0.0
    let timer = Timer.publish(every: 1, on: .main, in: .common).autoconnect()
    var body: some View {
        ZStack {
            Circle()
                .stroke(lineWidth: 20.0)
                .opacity(0.3)
                .foregroundColor(.red)
            Circle()
                .trim(from: 0.0, to: CGFloat(min(progressCookedValue, 100) / 100))
                .stroke(style: StrokeStyle(lineWidth: 20.0, lineCap: .round, lineJoin: .round))
                .foregroundColor(.red)
                .rotationEffect(.degrees(-90))
            Text("\(String(format: "%.1f" ,(progressCookedValue)))% 조리가 완료 되었습니다.")
                .fontWeight(.bold)
            
            .onReceive(timer) { _ in
                if self.progressCookedValue < 100 {
                    self.progressCookedValue += 0.5
                } else {
                    self.timer.upstream.connect().cancel()
                }
            }
        }
        .frame(width: 300, height: 300, alignment: .center)
    }
}
```   
이때 SwiftUI에서 progressCookedValue에 State를 붙이지 않는다면 에러가 발생한다. 해당 사유는, @State 키워드가 @propertyWrapper로서, 해당 state value의 값이 변화하면 현재 view가 무효화되고, 새롭게 계산된다.        
[StackOverFlow State 설명](https://stackoverflow.com/questions/56438730/what-does-the-swiftui-state-keyword-do, "State Explaination")을 참고하면 된다.      
timer를 통해서 1초마다 새로운 값이 없데이트 되고, 만약 100%가 될 때, timer의 연결을 끊어준다. 


# 3. SwiftUI에서 List
SwiftUI에서는 기존에 UIKit에서 보여준 TableViewCell과 달리 List라는 것을 사용한다. 해당 List는 기존에 TableViewCell과 같이 스크롤을 자동적으로 지원하는 것으로 보인다. 
또한 TableViewCell과 같이 cell을 reuse하는 것으로 보이며 [StackOverFlow List](https://stackoverflow.com/questions/56655421/does-the-list-in-swiftui-reuse-cells-similar-to-uitableview, "SwiftUI List Reuse cells")에 메모리 사용량을 통해서 확인할 수 있다. 
[SwiftUI Apple documentation](https://developer.apple.com/documentation/swiftui/list, "SwiftUI List Documentation")을 참고하면, 해당 List는 Dictionary에 저장된 값들을 나열할 수 있고, MultiSelection, Tree구조 등 다양한 기능을 지원한다. 

## 가장 기본적인 사용법
<img src="https://github.com/yudonlee/TIL/blob/main/iOS/2022/April/pictures/04_01_List.png" width="400" height="600">

```swift
List {
                Text("호랑이")
                Text("사자")
                Text("곰")
                Text("삵")
                Text("퓨마")
                Text("재규어")
                Text("하이애나")
            }
```

## Header를 추가하여 Section에 제목을 만들기 
```swift
List {
                Section(header: Text("육식동물"), content: {
                    Text("호랑이")
                    Text("사자")
                    Text("곰")
                    Text("삵")
                    Text("퓨마")
                    Text("재규어")
                    Text("하이애나")
                })
                Section(header: Text("초식동물"), content: {
                    Text("고라니")
                    Text("멧돼지")
                    Text("소")
                    Text("닭")
                    Text("염소")
                })
                
            }
```